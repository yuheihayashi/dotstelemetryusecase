<?xml version="1.0" encoding="US-ASCII"?>
<!--
<!DOCTYPE rfc SYSTEM "rfc2629.dtd" []>
<?rfc toc="yes"?>
<?rfc tocompact="yes"?>
<?rfc tocdepth="3"?>
<?rfc tocindent="yes"?>
<?rfc symrefs="yes"?>
<?rfc sortrefs="yes"?>
<?rfc comments="yes"?>
<?rfc inline="yes"?>
<?rfc compact="yes"?>
<?rfc subcompact="no"?>
-->
<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
<!-- One method to get references from the online citation libraries.
     There has to be one entity for each item to be referenced.
     An alternate method (rfc include) is described in the references. -->
]>
<?xml-stylesheet type='text/xsl' href='rfc2629.xslt' ?>
<!-- used by XSLT processors -->
<!-- For a complete list and description of processing instructions (PIs),
      please see http://xml.resource.org/authoring/README.html. -->
<!-- Below are generally applicable Processing Instructions (PIs) that most I-Ds might want to use.
     (Here they are set differently than their defaults in xml2rfc v1.32) -->
<?rfc strict="yes" ?>
<!-- give errors regarding ID-nits and DTD validation -->
<!-- control the table of contents (ToC) -->
<?rfc toc="yes"?>
<!-- generate a ToC -->
<?rfc tocdepth="4"?>
<!-- the number of levels of subsections in ToC. default: 3 -->
<!-- control references -->
<?rfc symrefs="yes"?>
<!-- use symbolic references tags, i.e, [RFC2119] instead of [1] -->
<?rfc sortrefs="yes" ?>
<!-- sort the reference entries alphabetically -->
<!-- control vertical white space
     (using these PIs as follows is recommended by the RFC Editor) -->
<?rfc compact="yes" ?>
<!-- do not start each main section on a new page -->
<?rfc subcompact="no" ?>
<!-- keep one blank line between list items -->
<!-- end of list of popular I-D processing instructions -->
<rfc category="info" docName="draft-hayashi-dots-telemetry-use-cases-00">
  <!-- ***** FRONT MATTER ***** -->
  <front>
    <title abbrev="DOTS Telemetry Use Cases">Use Cases for DDoS Open Threat Signaling (DOTS) Telemetry</title>
    <author fullname="Yuhei Hayashi" initials="Y." surname="Hayashi">
      <organization abbrev="NTT">
        NTT
      </organization>
      <address>
        <postal>
          <street>3-9-11, Midori-cho</street>
          <city>Musashino-shi</city>
          <region>Tokyo</region>
          <code>180-8585</code>
          <country>Japan</country>
        </postal>
        <email>yuuhei.hayashi@gmail.com</email>
      </address>
    </author>
    <author fullname="Meiling Chen" initials="M." surname="Chen">
     <organization abbrev="CMCC">
       CMCC
     </organization>
     <address>
       <postal>
         <street>32, Xuanwumen West </street>
         <city>BeiJing</city>
         <region>BeiJing</region>
         <code>100053</code>
         <country>China</country>
       </postal>
       <email>
         chenmeiling@chinamobile.com
       </email>
     </address>
   </author>
    <date day="2" month="December" year="2019" />
    <area>Security Area</area>
    <workgroup>DOTS</workgroup>
    <keyword>Internet-Draft</keyword>
    <abstract>
      <t>
        DOTS Telemetry enriches base DOTS protocol to assist the mitigator to perform efficient DDoS attack mitigation techniques in the network.
        This document presents sample use cases for DOTS telemetry: what components are deployed in the network, how they collaborate, and what information is exchanged to perform the techniques.
      </t>
    </abstract>
  </front>
  <middle>
    <section anchor="section_introduction" title="Introduction">
      <t>
        Denial-of-Service (DDoS) attacks such as volumetric attacks or resource consumption attacks are critical threats to be handled by service providers.
        When such DDoS attacks occur, service providers have to mitigate them immediately to protect or recover their services.
      </t>
      <t>
        Therefore, for the service providers to immediately protect their network services from DDoS attacks, DDoS mitigation needs to be automated.
        To automate DDoS attack mitigation, it is desirable that multi-vendor elements involved in DDoS attack detection and mitigation collaborate and support standard interfaces to communicate.
      </t>
      <t>
        DDoS Open Threat Signaling (DOTS) is a set of protocols for real-time signaling, threat-handling requests, and data filtering between the multi-vendor elements <xref target="I-D.ietf-dots-signal-channel" /><xref target="I-D.ietf-dots-data-channel" />.
        Furthermore, DOTS Telemetry enriches the DOTS protocol with various telemetry attributes allowing optimal DDoS attack mitigation <xref target="I-D.ietf-dots-telemetry" />.
        This document presents sample use cases for DOTS telemetry: what components are deployed in the network, how they collaborate, and what information is exchanged to perform the attack mitigation techniques.
      </t>
    </section>
    <section anchor="section_terms" title="Terminology">
      <t>
        The readers should be familiar with the terms defined in <xref target="RFC8612"/>
      </t>
      <t>
        In addition, this document makes use of the following terms:
      </t>
      <t>
        <list style="hanging">
          <t hangText="Top-talker:">
            A top N list of attackers who attack the same target or targets.
            The list is ordered in terms of a two-tuple bandwidth such as bps or pps.
          </t>
          <t hangText="Supervised Machine Learning:">
            A machine learning technique that maps an input to an output based on example input-output pairs
          </t>
        </list>
      </t>
    </section>
    <section anchor="section_use_cases" title="Use Cases">
      <t>
        This section describes DOTS Telemetry use cases which uses attributes included in DOTS telemetry spec.
      </t>
      <section anchor="section_use_cases_ddos_mitigation_bandwidth" title="DDoS Mitigation Based on Attack Traffic Bandwidth">
        <section anchor="section_use_cases_ddos_mitigation_bandwidth_top-talker" title="Mitigating Attack Flow of Top-talker Preferentially">
          <t>
            Large-scale DDoS attack such as amplification attack often occurs in the world these days.
            On the other hand, some transit providers have to mitigate the large-scale DDoS attack using DMS with limited resources, which is already deployed in their network.
          </t>
          <t>
            The aim of this use case is to enable the transit providers to use their DMS efficiently under volume-based DDoS attacks whose bandwidth is more than the available capacity of the DMS.
            To perform it, attack traffics of top talkers are redirected to their DMS preferentially by collaborating forwarding nodes, flow collectors and orchestrators.
            Figure 1 shows the abstract of the use case.
          </t>
          <t>
            <figure align="center">
              <artwork><![CDATA[
      (Internet Transit Provider)

                 +-----------+      +--------------+ e.g. SNMP
   e.g. NetFlow +-----------+| DOTS |              |<---
            --->| Flow      ||C<-->S| Orchestrator | e.g. BGP Flowspec
                | collector |+      |              |--->
                +-----------+       +--------------+

                         +------------+
           e.g. NetFlow +------------+| e.g. BGP Flowspec
                    <---| Forwarding ||<---
                        |    nodes   ||                   DDoS Attack
[ Target  ]<============|======================================
|   or    |             |    ++============================[top talker]
[ Targets ]             |    || ++=========================[top talker]
                        +----|| ||---+
                             || ||
                             || ||
                             |/ |/
                        +----x--x----+
                        | DDoS       | e.g. SNMP
                        | mitigation |<---
                        | system     |
                        +------------+

          * C is for DOTS client functionality
          * S is for DOTS client functionality

Figure 1: Mitigating DDoS Attack Flow of Top-talker Preferentially

              ]]></artwork>
            </figure>
          </t>
          <t>
            In the use case, the forwarding nodes always send statistics of traffic flow to the flow collectors by using monitoring functions such as NetFlow.
            When DDoS attacks occur, the flow collectors detect attack traffic and send (src_ip, dst_ip, bandwidth)-tuple information of the top talker to the orchestrator, using top-talkers attribute of DOTS Telemetry.
            Then, the orchestrator checks the available capacity of DMS by using network management protocol such as SNMP<xref target="RFC4271" />.
            After that, the orchestrator orders forwarding nodes to redirect the top taker's traffic to the DMS as much as possible by dissemination of flow specification rules protocols such as BGP Flowspec <xref target="RFC5575" />.
          </t>
          <t>
            In this case, the flow collector implements a DOTS client while the orchestrator implements a DOTS server.
          </t>
        </section>
        <section anchor="dms_selection" title="Optimal DMS Selection for Mitigation">
          <t>
            Transit providers, which have a number of DMSs, usually deploy the DMS in various forms to satisfy their requirments; individual form or clustered form.
            In both form, they can identify attributes of the DMSs such as total capacity, available capacity and the last hop bandwidth.
          </t>
          <t>
            The aim of this use case is to enable the transit providers to select optimal DMS for mitigation based on the bandwidth of attack traffic, capacity of DMS and the last hop bandwidth.
            Figure 2 shows the abstract of the use case.
          </t>
          <t>
            <figure align="center">
              <artwork><![CDATA[
      (Internet Transit Provider)

                 +-----------+      +--------------+ e.g. SNMP
   e.g. NetFlow +-----------+| DOTS |              |<---
            --->| Flow      ||C<-->S| Orchestrator | e.g. BGP
                | collector |+      |              |--->
                +-----------+       +--------------+

                         +------------+
           e.g. NetFlow +------------+| e.g. BGP
                    <---| Forwarding ||<---
                        |    nodes   ||                  DDoS Attack
[Target]                | ++===================================
[Target]                | ||  ++===============================
                        +-||--||-----+
                          ||  ||
                    ++====++  ||
                    ||        ||  +-----------+
                    ||        |/  |      DMS3 |(congested)
                    ||  +-----x------+        |<--- e.g. SNMP
                    |/  |       DMS2 |--------+
                 +--x---------+      |<--- e.g. SNMP
                 |       DMS1 |------+
                 |            |<--- e.g. SNMP
                 +------------+

          * C is for DOTS client functionality
          * S is for DOTS client functionality

Figure 2: Optimal DMS selection for Mitigation
              ]]></artwork>
            </figure>
          </t>
          <t>
            In the use case, the forwarding nodes always send statistics of traffic flow to the flow collectors by using monitoring functions such as NetFlow.
            When DDoS attacks occur, the flow collectors detect attack traffic and send (dst_ip, bandwidth)-tuple information to the orchestrator, using total-attack-traffic attribute of DOTS Telemetry.
            Then, the orchestrator checks the available capacity of DMS by using network management protocol such as SNMP<xref target="RFC4271" />.
            After that, the orchestrator chooses optimal DMS which each attack traffic should be redirected.
            After that, the orchestrator orders forwarding nodes to redirect the attack traffic to the optimal DMS by routing protocol such as BGP<xref target="RFC4271" />.
            The algorithm of choosing DMS is out of scope in this draft.
          </t>
          <t>
            In this case, the flow collector implements a DOTS client while the orchestrator implements a DOTS server.
          </t>
        </section>
        <section anchor="redirection_path_selection" title="Best Path Selection for Redirection">
          <t>
            Transit provider network which adopts mesh network has multiple routes to convey attack traffic to DMS.
            In the network, attack traffic can be conveyed while avoids congested links by selecting available path.
          </t>
          <t>
            The aim of this use case is to enable the transit providers to select optimal path for redirecting attack traffic to DMS according to the bandwidth of attack traffic and total traffic, total pipe capability.
            Figure 3 shows the abstract of the use case.
          </t>
          <t>
            <figure align="center">
              <artwork><![CDATA[
      (Internet Transit Provider)

                     +-----------+      +--------------+  DOTS
       e.g. NetFlow +-----------+| DOTS |              |S<---
                --->| Flow      ||C<-->S| Orchestrator | e.g. BGP Flow spec
                    | collector |+      |              |--->
                    +-----------+       +--------------+

              DOTS +------------+    DOTS +------------+ e.g. NetFlow
              --->C| Forwarding |    --->C| Forwarding |--->
e.g. BGP Flow spec |   node     |         |   node     |
               --->|            |         |            |
[Target]           |       ++==========================================
                   +-------||---+         +------------+     DDoS Attack
                           ||             /
                           ||            / (congested link)
                   DOTS  +-||----------------+
                    --->C| ||  Forwarding    |
                         | ++===  node       |
                         +----||-------------+
                              |/
                           +--x-----------+
                           |     DMS      |
                           +--------------+

         * C is for DOTS client functionality
         * S is for DOTS client functionality

Figure 3: Best Path Selection for Redirection
              ]]></artwork>
            </figure>
          </t>
          <t>
            In the use case, the forwarding nodes always send statistics of traffic flow to the flow collectors by using monitoring functions such as NetFlow.
            When DDoS attacks occur, the flow collectors detect attack traffic and send (dst_ip, bandwidth)-tuple information to the orchestrator, using total-attack-traffic attribute of DOTS Telemetry.
            On the other hands, forwarding nodes send bandwidth of total traffic passing the node and total pipe capability to the orchestrator, using total-traffic and total-pipe-capability attributes of DOTS Telemetry.
            Then, the orchestrator choose optimal path which each attack traffic should be redirected.
            After that, the orchestrator orders forwarding nodes to redirect the attack traffic to the optimal DMS by dissemination of flow specification rules protocols such as BGP Flowspec <xref target="RFC5575" />.
            The algorithm of choosing path is out of scope in this draft.
          </t>
        </section>
        <section anchor="section_use_cases_ddos_mitigation_bandwidth_offloadingvolumetricattackflow" title="Offloading Extream Volumetric Attack Flow">
           <t>
           	Typically, the bandwidth between the attack target and the previous hop route is fixed because the bandwidth is charged based on the size of the bandwidth. If there is a large amount of attack traffic, the whole link is already full, and the attack traffic cannot be mitigated through redirection and cleaning operation. In this case, direct discarding is usually adopted to ensure part of the normal service flow, and the patency of pipeline is given priority. How to identify a super large traffic attack, for example, the attack traffic is not only larger than the bandwidth of last hop, but also larger than the higher path hop, that means the excess traffic of bandwidth A will be discarded, and in this case no need to distinguish between attack traffic and normal traffic.
          </t>
          <t>
          	<figure align="center">
          			<artwork><![CDATA[
          				+-------------+             +-----------+
          				|attack target|----client-->|dots server|
          				+-------------+             +-----------+
          				       |                         |
          				       |(bandwidth A)            |
          				   +--------+               +--------+
          				   | router |---------------| router |
          				   +--------+ (bandwidth B) +--------+

Figure 4: Offloading Extream Volumetric Attack Flow

          			]]></artwork>
          		</figure>
          </t>
        </section>
      </section>
      <section anchor="section_use_cases_ddos_mitigation_attack_type" title="DDoS Mitigation Based on Attack Type">
        <section anchor="section_use_cases_ddos_mitigation_attack_type_techniqueselection" title="Selecting Mitigation Technique">
          <t>
            Some volumetric attacks such as amplification attack can be detected with high accuracy by checking layer 3 or layer 4 information of attack packets.
            These attacks can be detected and mitigated by collaborating forwarding nodes and flow collectors using NetFlow.
            On the other hand, it is necessary to inspect layer 7 information of attack packets to detect some attacks such as DNS Water Torture Attack.
            These attacks traffic should be detected and mitigated at DMS.
          </t>
          <t>
            Aim of this use case is to enable the transit providers to select mitigation technique based on the type of attack traffic: amplification attack or not.
            To perform it, attack traffic is blocked at forwarding nodes or redirected to DMS base on attack type by collaborating forwarding nodes, flow collectors and an orchestrator.
            Figure 5 shows the abstract of the use case.
          </t>
          <t>
            <figure align="center">
              <artwork><![CDATA[
      (Internet Transit Provider)

                 +-----------+      +--------------+
                +-----------+| DOTS |              |
   e.g. NetFlow | Flow      ||<---->| Orchestrator | e.g. BGP, BGP Flowspec
            --->| collector ||C    S|              |--->
                +-----------++      +--------------+

                         +------------+
           e.g. NetFlow +------------+| e.g. BGP, BGP Flowspec
                    <---| Forwarding ||<---
                        |    nodes   ||                    DDoS Attack
                        |     ++=====||========================
                        |     ||     ||x<==================[e.g.DNS Amp]
                        |     ||     |+x<==================[e.g.NTP Amp]
                        +-----||-----+
                              ||
                              |/
                        +-----x------+
                        | DDoS       |
                        | mitigation |
                        | system     |
                        +------------+

          * C is for DOTS client functionality
          * S is for DOTS server functionality

Figure 5: DDoS Mitigation Based on Attack Type

              ]]></artwork>
          </figure>
        </t>
        <t>
          In the use case, the forwarding nodes send statistics of traffic flow to the flow collectors by using monitoring function such as NetFlow.
          When DDoS attacks occur, the flow collectors detect attack traffic and send (dst_ip, src_port, attack_type)-tuple information to the orchestrator, using attack-name attribute of DOTS Telemetry.
          Then, the orchestrator orders forwarding nodes to block (dst_ip, src_port)-tuple flow of amp attack traffic by dissemination of flow specification rules protocols such as BGP Flowspec<xref target="RFC5575" />.
          On the other hand, the orchestrator orders forwarding nodes to redirect other than the amp attack traffic by routing protocol such as BGP<xref target="RFC4271" />.
        </t>
        <t>
          In this case, the flow collector implements a DOTS client while the orchestrator implements a DOTS server.
        </t>
        </section>
      </section>
      <section anchor="section_use_cases_ddos_detection_training" title="Training Flow Collector Using Supervised Machine Learning">
        <t>
          DDoS detection based on flow monitoring such as NetFlow is a lighter weight way to detect DDoS attacks than DMS in the internet transit provider network.
          On the other hand, DDoS detection based on DMS is a more accurate way to detect DDoS attacks than DDoS detection based on flow monitoring.
        </t>
        <t>
          Aim of this use case is that the flow collector raises their detection accuracy performance carrying out supervised machine learning techniques based on the detection result of DMS.
          To perform it, forwarding nodes, flow collector and a DMS collaborate.
          Figure 5 shows the abstract of the use case.
        </t>
        <t>
          <figure align="center">
            <artwork><![CDATA[

                                +-----------+
                               +-----------+| DOTS
                  e.g. NetFlow | Flow      ||S<---
                           --->| collector ||
                               +-----------++

                                +------------+
                  e.g. NetFlow +------------+|
                           <---| Forwarding ||
                               |    nodes   ||                 DDoS Attack
 [ Target ]                    |   ++==============================
                               |   || ++===========================
                               |   || || ++========================
                               +---||-|| ||-+
                                   || || ||
                                   |/ |/ |/
                         DOTS  +---X--X--X--+
                          --->C| DDoS       |
                               | mitigation |
                               | system     |
                               +------------+

        * C is for DOTS client functionality
        * S is for DOTS client functionality

Figure 6: Training Flow Collector Using Supervised Machine Learning
            ]]></artwork>
          </figure>
        </t>
        <t>
          In the use case, the forwarding nodes always send statistics of traffic flow to the flow collectors by using monitoring functions such as NetFlow.
          When DDoS attacks occur, DDoS orchestration use case<xref target="I-D.ietf-dots-use-cases"/> is carried out and DMS mitigates all attack traffic destined a target.
          Then, DDoS Mitigation system reports (src_ip, dst_ip)-tuple information of the top talker to the orchestrator, using top-talkers attribute of DOTS Telemetry.
        </t>
        <t>
          After mitigating DDoS attack, the flow collector attaches teacher labels to the stastistics of traffic flow based on the reports.
          The label shows normal traffic or attack traffic, or attack name.
          Then, the flow collector carry out supervised machine learning to raise their detection accuracy, setting the statistics as explanatory variable and setting the labels as objective variable.
        </t>
        <t>
          In this case, the DMS implements a DOTS client while the flow collector implements a DOTS server.
        </t>
      </section>
    </section>
    <section title="Security Considerations">
      <t>
        TBD
      </t>
    </section>
    <section title="IANA Considerations">
      <t>
        This document does not require any action from IANA.
      </t>
    </section>
    <section title="Acknowledgement">
      <t>
        The authors would like to thank among others brabra...
      </t>
    </section>
  </middle>
  <!-- ***** BACK MATTER ***** -->
  <back>
    <references title="Normative References">
      <?rfc include="reference.I-D.ietf-dots-telemetry"?>
      <?rfc include="reference.I-D.ietf-dots-use-cases"?>
      <?rfc include="reference.RFC.4271"?>
      <?rfc include="reference.RFC.5575"?>
      <?rfc include="reference.RFC.8612"?>
      <?rfc include="reference.RFC.3413"?>
    </references>
    <references title="Informative References">
      <?rfc include="reference.I-D.ietf-dots-signal-channel"?>
      <?rfc include="reference.I-D.ietf-dots-data-channel"?>
    </references>
    <!-- Appendix -->
  </back>
</rfc>
