<?xml version="1.0" encoding="US-ASCII"?>
<!--
<!DOCTYPE rfc SYSTEM "rfc2629.dtd" []>
<?rfc toc="yes"?>
<?rfc tocompact="yes"?>
<?rfc tocdepth="3"?>
<?rfc tocindent="yes"?>
<?rfc symrefs="yes"?>
<?rfc sortrefs="yes"?>
<?rfc comments="yes"?>
<?rfc inline="yes"?>
<?rfc compact="yes"?>
<?rfc subcompact="no"?>
-->
<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
<!-- One method to get references from the online citation libraries.
     There has to be one entity for each item to be referenced.
     An alternate method (rfc include) is described in the references. -->
]>
<?xml-stylesheet type='text/xsl' href='rfc2629.xslt' ?>
<!-- used by XSLT processors -->
<!-- For a complete list and description of processing instructions (PIs),
      please see http://xml.resource.org/authoring/README.html. -->
<!-- Below are generally applicable Processing Instructions (PIs) that most I-Ds might want to use.
     (Here they are set differently than their defaults in xml2rfc v1.32) -->
<?rfc strict="yes" ?>
<!-- give errors regarding ID-nits and DTD validation -->
<!-- control the table of contents (ToC) -->
<?rfc toc="yes"?>
<!-- generate a ToC -->
<?rfc tocdepth="4"?>
<!-- the number of levels of subsections in ToC. default: 3 -->
<!-- control references -->
<?rfc symrefs="yes"?>
<!-- use symbolic references tags, i.e, [RFC2119] instead of [1] -->
<?rfc sortrefs="yes" ?>
<!-- sort the reference entries alphabetically -->
<!-- control vertical white space
     (using these PIs as follows is recommended by the RFC Editor) -->
<?rfc compact="yes" ?>
<!-- do not start each main section on a new page -->
<?rfc subcompact="no" ?>
<!-- keep one blank line between list items -->
<!-- end of list of popular I-D processing instructions -->
<rfc category="info" docName="draft-hayashi-dots-telemetry-use-cases-00">
  <!-- ***** FRONT MATTER ***** -->
  <front>
    <title abbrev="DOTS Telemetry Use Cases">Use Cases for DDoS Open Threat Signaling (DOTS) Telemetry</title>
    <author fullname="Yuhei Hayashi" initials="Y." surname="Hayashi">
      <organization abbrev="NTT">
        NTT
      </organization>
      <address>
        <postal>
          <street>3-9-11, Midori-cho</street>
          <city>Musashino-shi</city>
          <region>Tokyo</region>
          <code>180-8585</code>
          <country>Japan</country>
        </postal>
        <email>yuuhei.hayashi@gmail.com</email>
      </address>
    </author>
    <author fullname="Meiling Chen" initials="M." surname="Chen">
     <organization abbrev="CMCC">
       CMCC
     </organization>
     <address>
       <postal>
         <street>32, Xuanwumen West </street>
         <city>BeiJing</city>
         <region>BeiJing</region>
         <code>100053</code>
         <country>China</country>
       </postal>
       <email>
         chenmeiling@chinamobile.com
       </email>
     </address>
   </author>
    <date day="2" month="December" year="2019" />
    <area>Security Area</area>
    <workgroup>DOTS</workgroup>
    <keyword>Internet-Draft</keyword>
    <abstract>
      <t>
        DOTS Telemetry enriches base DOTS protocol to assist the mitigator to perform efficient DDoS attack mitigation techniques in the network.
        This document presents sample use cases for DOTS telemetry: what components are deployed in the network, how they collaborate, and what information is exchanged to perform the techniques.
      </t>
    </abstract>
  </front>
  <middle>
    <section anchor="section_introduction" title="Introduction">
      <t>
        Denial-of-Service (DDoS) attacks such as volumetric attacks or resource consumption attacks are critical threats to be handled by service providers.
        When such DDoS attacks occur, service providers have to mitigate them immediately to protect or recover their services.
      </t>
      <t>
        Therefore, for the service providers to immediately protect their network services from DDoS attacks, DDoS mitigation needs to be automated.
        To automate DDoS attack mitigation, it is desirable that multi-vendor elements involved in DDoS attack detection and mitigation collaborate and support standard interfaces to communicate.
      </t>
      <t>
        DDoS Open Threat Signaling (DOTS) is a set of protocols for real-time signaling, threat-handling requests, and data filtering between the multi-vendor elements.
        Furthermore, DOTS Telemetry enriches the DOTS protocol with various telemetry attributes allowing optimal DDoS attack mitigation.
        This document presents sample use cases for DOTS telemetry: what components are deployed in the network, how they collaborate, and what information is exchanged to perform the attack mitigation techniques.
      </t>
    </section>
    <section anchor="section_terms" title="Terminology">
      <t>
        The readers should be familiar with the terms defined in brabra
      </t>
      <t>
        In addition, this document makes use of the following terms:
      </t>
      <t>
        <list style="hanging">
          <t hangText="brabra:">
            brabra
          </t>
        </list>
      </t>
    </section>
    <section anchor="section_use_cases" title="Use Cases">
      <t>
        This section describes DOTS Telemetry use cases use attributes included in DOTS telemetry spec.
      </t>
      <section anchor="section_use_cases_ddos_mitigation_bandwidth" title="DDoS Mitigation Based on Attack Traffic Bandwidth">
        <section anchor="section_use_cases_ddos_mitigation_bandwidth_top-talker" title="Mitigating Attack Flow of Top-talker Preferentially">
          <t>
            Large-scale DDoS attack such as amplification attack often occurs in the world these days.
            On the other hand, many transit providers have to mitigate the large-scale DDoS attack using DMS with limited resources, which is already deployed in their network.
          </t>
          <t>
            The aim of this use case is to enable the transit providers to use their DMS efficiently under volume-based DDoS attacks whose bandwidth is more than the available capacity of the DMS.
            To perform it, attack traffics of top talkers are redirected to their DMS preferentially by collaborating forwarding nodes, flow collectors and orchestrators.
          </t>
          <t>
            <figure align="center">
              <artwork><![CDATA[
          +-----------------------------------------------+
          | Internet Transit Provider                     |
          |                                               |
          |      +-----------+      +--------------+      |
          |     +-----------+| DOTS |              |      |
          |     | Flow      ||<---->| Orchestrator |---+  |
          |  +->| collector ||TC  TS|              |-+ |  |
          |  |  +-----------++      +--------------+ | |  |
          |  |                                       | |  |
          |  |  e.g.     +------------+ e.g.         | |  |
          |  |  NetFlow +------------+| BGP Flowspec | |  |
          |  +----------| Forwarding ||<-------------+ |  |
          |             |    nodes   ||                |  | DDoS Attack
[Target]<===============|============||================|========
          |             |    ++======||================|====[top talker]
          |             |    || ++===|+================|====[top talker]
          |             +----|| ||---+                 |  |
          |                  || ||                     |  |
          |                  |/ |/                     |  |
          |             +------------+  e.g.           |  |
          |             | DDoS       |  SNMP           |  |
          |             | mitigation |<----------------+  |
          |             | systems    |                    |
          |             +------------+                    |
          +-----------------------------------------------+

          * TC is for DOTS Telemetry client functionality
          * TS is for DOTS Telemetry server functionality

Figure 1: Mitigating DDoS Attack Flow of Top-talker Preferentially

              ]]></artwork>
            </figure>
          </t>
          <t>
            Figure 1 shows the abstract of the use case.
            In the use case, the forwarding nodes send statistics of traffic flow to the flow collectors by using monitoring functions such as NetFlow.
            When DDoS attacks occur, the flow collectors detect attack traffic and send (src_ip, dst_ip, bandwidth)-tuple information of the top talker to the orchestrator.
            Then, the orchestrator checks the available capacity of DMS.
            After that, the orchestrator orders forwarding nodes to redirect the top taker's traffic to the DMS as much as possible by dissemination of flow specification rules protocols such as BGP Flowspec.
          </t>
          <t>
            In this case, the flow collector implements a DOTS telemetry client while the orchestrator implements a DOTS server.
          </t>
        </section>
        <section anchor="dms_selection" title="Selecting Available DMS">
          <t>
            Usually, DDoS attack mitigation providers have a number of ddos clean devices which up to the capability of service, ddos clean device can exists in both individual and clustered forms that based on the network requirements, we can all identify it as a DMS, each DMS has three attributes: total capacity, surplus capacity, the last hop bandwidth(how to get the bandwidth of last hop can refer to segment routing technology). When ddos attack occurs, DOTS telemetry carries the value of total attack traffic, orchestrator based on the total attack traffic, and each DMS's triad parameters to select the optimal DMS for mitigation. How to make the decision of DMS will be based on the first principle that operate fast and efficiently, and the detail algorithm is out of scope, this scenario is suitable for scenarios that are sensitive to the processing capabilities of the DMS.
          </t>
          <t>
            <figure align="center">
              <artwork><![CDATA[

                 +------------+ (total attack traffic,dst) +-----------+
                 |orchestrator|----------------------------|dots server|
                 +------------+                            +-----------+
                   |
                +--------+
                | router |
                +--------+
                     |
            +------------+-------------+
            |            |             |(last hop bandwidth)
            |            |             |
          +--------+   +--------+     +--------+
          |device 1|   |device 2|     |device 3|(total capacity,surplus capacity)
          +--------+   +--------+     +--------+

          * dst ip can be ipv4 and ipv6
Figure 2: Optimal DMS selection for mitigation

              ]]></artwork>
            </figure>
          </t>
        </section>
        <section anchor="redirection_path_selection" title="Selecting Best Path for Redirection">
          <t>
            Choosing the appropriate path for traffic redirection can also based on the total attack traffic and total pipe capability, but only internet service providers have the ability to know the overall load capacity of each physical paths and load limitation. ISP has many DMS and they are deployed according to the administrative division. After the ddos attack traffic are redirected to the DMS, DMS can perform cleaning operation and inject the normal service flow back. From the perspective of network load management, how to select the bast way to redirect requires the calculation on total attack traffic(TAT),total traffic(TT) and total pipe capability(TPC).
          </t>
          <t>
            <figure align="center">
              <artwork><![CDATA[
                +--------+       +------------+
                | router |-------|orchestrator|
                +--------+       +------------+
                     |           (TAT, TT, TPC)
                     |(TT,TPC)
          **************************************
          (     [router]---------[router]      )
          (         |   (TT,TPC)   |           )
          (         \              /           )
          (  (TT,TPC)\            /(TT,TPC)    )
          (			  \ [router] /             )
          **************************************
                           |
                           |
                       +-------+
                       |  DMS  |
                       +-------+

         * TAT is for total attack traffic
         * TT is for total traffic
         * TPC is for total pipe capability

Figure 3: Optimal redirection path for mitigation

              ]]></artwork>
            </figure>
          </t>
        </section>
        <section anchor="section_use_cases_ddos_mitigation_bandwidth_offloadingvolumetricattackflow" title="Offloading Extream Volumetric Attack Flow">
           <t>
           	Typically, the bandwidth between the attack target and the previous hop route is fixed because the bandwidth is charged based on the size of the bandwidth. If there is a large amount of attack traffic, the whole link is already full, and the attack traffic cannot be mitigated through redirection and cleaning operation. In this case, direct discarding is usually adopted to ensure part of the normal service flow, and the patency of pipeline is given priority. How to identify a super large traffic attack, for example, the attack traffic is not only larger than the bandwidth of last hop, but also larger than the higher path hop, that means the excess traffic of bandwidth A will be discarded, and in this case no need to distinguish between attack traffic and normal traffic.
          </t>
          <t>
          	<figure align="center">
          			<artwork><![CDATA[
          				+-------------+             +-----------+
          				|attack target|----client-->|dots server|
          				+-------------+             +-----------+
          				       |                         |
          				       |(bandwidth A)            |
          				   +--------+               +--------+
          				   | router |---------------| router |
          				   +--------+ (bandwidth B) +--------+

          	Figure 4: Offloading Extream Volumetric Attack Flow

          			]]></artwork>
          		</figure>

          </t>
        </section>
      </section>
      <section anchor="section_use_cases_ddos_mitigation_attack_type" title="DDoS Mitigation Based on Attack Type">
        <section anchor="section_use_cases_ddos_mitigation_attack_type_techniqueselection" title="Selecting Mitigation Technique">
          <t>
            Some volumetric attacks such as amplification attack can be detected with high accuracy by checking layer 3 or layer 4 information of attack packets.
            These attacks can be detected and mitigated by collaborating forwarding nodes and flow collectors using NetFlow.
            On the other hand, it is necessary to inspect layer 7 information of attack packets to detect some attacks such as DNS Water Torture Attack.
            These attacks traffic should be detected and mitigated at DMS.
          </t>
          <t>
            Aim of this use case is to enable the transit providers to select mitigation technique based on the type of attack traffic: amplification attack or not.
            To perform it, attack traffic is blocked at forwarding nodes or redirected to DMS base on attack type by collaborating forwarding nodes, flow collectors and an orchestrator.
          </t>
          <t>
            <figure align="center">
              <artwork><![CDATA[
          +-----------------------------------------------+
          | Internet Transit Provider                     |
          |                                               |
          |      +-----------+      +--------------+      |
          |     +-----------+| DOTS |              |      |
          |     | Flow      ||<---->| Orchestrator |      |
          |  +->| collector ||TC  TS|              |---+  |
          |  |  +-----------++      +--------------+   |  |
          |  |                           e.g.          |  |
          |  |  e.g.     +------------+  BGP,          |  |
          |  |  NetFlow +------------+|  BGP Flowspec  |  |
          |  +----------| Forwarding ||<---------------+  |
          |             |    nodes   ||                   | DDoS Attack
          |             |     ++=====||========================
          |             |     ||     ||X<==================[e.g.DNS Amp]
          |             |     ||     |+X<==================[e.g.NTP Amp]
          |             +-----||-----+                    |
          |                   ||                          |
          |                   |/                          |
          |             +-----X------+                    |
          |             | DDoS       |                    |
          |             | mitigation |                    |
          |             | systems    |                    |
          |             +------------+                    |
          +-----------------------------------------------+

          * TC is for DOTS Telemetry client functionality
          * TS is for DOTS Telemetry server functionality

Figure 3: DDoS Mitigation Based on Attack Type

              ]]></artwork>
            </figure>
          </t>
          <t>
            Figure 3 shows the abstract of the use case.
            In the use case, the forwarding nodes send statistics of traffic flow to the flow collectors by using monitoring function such as NetFlow.
            When DDoS attacks occur, the flow collectors detect attack traffic and send (dst_ip, src_port, attack_type)-tuple information to the orchestrator.
            Then, the orchestrator orders forwarding nodes to block (dst_ip, src_port)-tuple flow of amp attack traffic by dissemination of flow specification rules protocols such as BGP Flowspec.
            On the other hand, the orchestrator orders forwarding nodes to redirect other than the amp attack traffic by routing protocol such as BGP.
          </t>
          <t>
            In this case, the flow collector implements a DOTS telemetry client while the orchestrator implements a DOTS server.
          </t>
        </section>

      </section>
      <section anchor="section_use_cases_ddos_detection_support" title="DDoS Detection Support Using Machine Learning">
        <t>
          DDoS detection based on flow monitoring such as NetFlow is a lighter weight way to detect DDoS attacks than DMS in the internet transit provider network.
          On the other hand, DDoS detection based on DMS is a more accurate way to detect DDoS attacks than flow monitoring.
        </t>
        <t>
          Aim of this use case is that the flow collector raises their detection accuracy performance carrying out supervised machine learning techniques based on the detection result of DMS.
          To perform it, forwarding nodes, flow collector and a DMS collaborate.
        </t>
        <t>
          <figure align="center">
            <artwork><![CDATA[
              +----------------------------------------------+
              | Internet Transit Provider                    |
              |                                              |
              |      TS+------------+                        |
              |  +---->|    Flow    |                        |
              |  |  +->| collector  |                        |
              |  |  |  +------------+                        |
              |  |  |                                        |
              |  |  | e.g.      +------------+               |
              |  |  | NetFlow  +------------+|               |
              |  |  +----------| Forwarding ||               |
              |  |             |    nodes   ||               |  DDoS Attack
 [ Target ]   |  |             |   ++=======||=====================
              |  |             |   || ++====||=====================
              |  |             |   || || ++=|+=====================
              |  |             +---||-|| ||-+                |
              |  |                 || || ||                  |
              |  |                 |/ |/ |/                  |
              |  |    DOTS     +---X--X--X--+                |
              |  +------------>| DDoS       |                |
              |              TC| mitigation |                |
              |                | systems    |                |
              |                +------------+                |
              +----------------------------------------------+

        * C is for DOTS Telemetry client functionality
        * S is for DOTS Telemetry server functionality

Figure 5: DDoS Detection Support Using Machine Learning
            ]]></artwork>
          </figure>
        </t>
        <t>
          Figure 5 shows the abstract of the use case.
          In the use case, the forwarding nodes send statistics of traffic flow to the flow collectors by using monitoring functions such as NetFlow.
          When DDoS attacks occur, DDoS orchestration use case is carried out and mitigate attack traffic at the DMS.
          Then, DDoS Mitigation system reports (src_ip, dst_ip, src_port, dst_port, attack_type)-tuple information of detected attack traffic to flow collector.
          Finally, the flow collector attaches teacher label to the NetFlow using the reports, and carry out supervised machine learning and raise their detection accuracy.
        </t>
        <t>
        In this case, the DMS implements a DOTS telemetry client while the flow collector implements a DOTS server.
        </t>
      </section>
    </section>
    <section title="Security Considerations">
      <t>
        The document does not describe any protocol.
      </t>
    </section>
    <section title="IANA Considerations">
      <t>
        This document does not require any action from IANA.
      </t>
    </section>
    <section title="Acknowledgement">
      <t>
        The authors would like to thank among others brabra...
      </t>
    </section>
  </middle>
  <!-- ***** BACK MATTER ***** -->
  <back>
    <references title="Normative References">
      <?rfc include="reference.I-D.ietf-dots-data-channel"?>
      <?rfc include="reference.I-D.ietf-dots-signal-channel"?>
    </references>
    <references title="Informative References">
      <?rfc include="reference.I-D.ietf-dots-use-cases"?>
    </references>
    <!-- Appendix -->
  </back>
</rfc>
