<?xml version="1.0" encoding="US-ASCII"?>
<!--
<!DOCTYPE rfc SYSTEM "rfc2629.dtd" []>
<?rfc toc="yes"?>
<?rfc tocompact="yes"?>
<?rfc tocdepth="3"?>
<?rfc tocindent="yes"?>
<?rfc symrefs="yes"?>
<?rfc sortrefs="yes"?>
<?rfc comments="yes"?>
<?rfc inline="yes"?>
<?rfc compact="yes"?>
<?rfc subcompact="no"?>
-->
<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
<!-- One method to get references from the online citation libraries.
     There has to be one entity for each item to be referenced.
     An alternate method (rfc include) is described in the references. -->
]>
<?xml-stylesheet type='text/xsl' href='rfc2629.xslt' ?>
<!-- used by XSLT processors -->
<!-- For a complete list and description of processing instructions (PIs),
      please see http://xml.resource.org/authoring/README.html. -->
<!-- Below are generally applicable Processing Instructions (PIs) that most I-Ds might want to use.
     (Here they are set differently than their defaults in xml2rfc v1.32) -->
<?rfc strict="yes" ?>
<!-- give errors regarding ID-nits and DTD validation -->
<!-- control the table of contents (ToC) -->
<?rfc toc="yes"?>
<!-- generate a ToC -->
<?rfc tocdepth="4"?>
<!-- the number of levels of subsections in ToC. default: 3 -->
<!-- control references -->
<?rfc symrefs="yes"?>
<!-- use symbolic references tags, i.e, [RFC2119] instead of [1] -->
<?rfc sortrefs="yes" ?>
<!-- sort the reference entries alphabetically -->
<!-- control vertical white space
     (using these PIs as follows is recommended by the RFC Editor) -->
<?rfc compact="yes" ?>
<!-- do not start each main section on a new page -->
<?rfc subcompact="no" ?>
<!-- keep one blank line between list items -->
<!-- end of list of popular I-D processing instructions -->
<rfc category="info" docName="draft-ietf-dots-telemetry-use-cases-02">
  <!-- ***** FRONT MATTER ***** -->
  <front>
    <title abbrev="DOTS Telemetry Use Cases">Use Cases for DDoS Open Threat Signaling (DOTS) Telemetry</title>
    <author fullname="Yuhei Hayashi" initials="Y." surname="Hayashi">
      <organization abbrev="NTT">
        NTT
      </organization>
      <address>
        <postal>
          <street>3-9-11, Midori-cho</street>
          <city>Musashino-shi</city>
          <region>Tokyo</region>
          <code>180-8585</code>
          <country>Japan</country>
        </postal>
        <email>yuuhei.hayashi@gmail.com</email>
      </address>
    </author>
    <author fullname="Meiling Chen" initials="M." surname="Chen">
     <organization abbrev="CMCC">
       CMCC
     </organization>
     <address>
       <postal>
         <street>32, Xuanwumen West </street>
         <city>BeiJing</city>
         <region>BeiJing</region>
         <code>100053</code>
         <country>China</country>
       </postal>
       <email>
         chenmeiling@chinamobile.com
       </email>
     </address>
   </author>
   <author initials="Li." surname="Su" fullname="Li Su">
      <organization>
        CMCC
      </organization>
      <address>
        <postal>
          <street>
            32, Xuanwumen West
          </street>
          <city>
            BeiJing
          </city>
          <code>
            100053
          </code>
          <country>
            China
          </country>
        </postal>
        <email>
          suli@chinamobile.com
        </email>
      </address>
    </author>
    <date day="01" month="July" year="2021" />
    <area>Security Area</area>
    <workgroup>DOTS</workgroup>
    <keyword>Internet-Draft</keyword>
    <abstract>
      <t>
        Denial-of-service Open Threat Signaling (DOTS) Telemetry enriches the base DOTS protocols to assist the mitigator in using efficient DDoS-attack-mitigation techniques in a network.
        This document presents sample use cases for DOTS Telemetry: what components are deployed in the network, how they cooperate, and what information is exchanged to effectively use these techniques.
      </t>
    </abstract>
  </front>
  <middle>
    <section anchor="section_introduction" title="Introduction">
      <t>
        Denial-of-Service (DDoS), attacks such as volumetric attacks and resource-consumption attacks, are critical threats to be handled by service providers.
        When such DDoS attacks occur, service providers have to mitigate them immediately to protect or recover their services.
      </t>
      <t>
        Therefore, for service providers to immediately protect their network services from DDoS attacks, DDoS mitigation needs to be automated.
        To automate DDoS-attack mitigation, multi-vendor components involved in DDoS-attack detection and mitigation should cooperate and support standard interfaces to communicate.
      </t>
      <t>
        DDoS Open Threat Signaling (DOTS) is a set of protocols for real-time signaling, threat-handling requests, and data filtering between the multi-vendor elements <xref target="RFC8782" /><xref target="RFC8783" />.
        Furthermore, DOTS Telemetry enriches the DOTS protocols with various telemetry attributes allowing optimal DDoS-attack mitigation <xref target="I-D.ietf-dots-telemetry" />.
        This document presents sample use cases for DOTS Telemetry, which makes concrete overview and purpose described in <xref target="I-D.ietf-dots-telemetry" />: what components are deployed in the network, how they cooperate, and what information is exchanged to effectively use attack-mitigation techniques.
      </t>
    </section>
    <section anchor="section_terms" title="Terminology">
      <t>
        The readers should be familiar with the terms defined in <xref target="RFC8612"/>
      </t>
      <t>
        In addition, this document uses the following terms:
      </t>
      <t>
        <list style="hanging">
          <t hangText="Top-talker:">
            A top N list of attackers who attack the same target or targets.
            The list is ordered in terms of a two-tuple bandwidth such as bps or pps.
          </t>
          <t hangText="Supervised Machine Learning:">
            A machine-learning technique that maps an input to an output based on example input-output pairs.
          </t>
          <t hangText="Unsupervised Machine Learning:">
            Unsupervised Learning is a machine learning technique in which the users do not need to supervise the model.
          </t>
        </list>
      </t>
    </section>
    <section anchor="section_use_cases" title="Use Cases">
      <t>
        This section describes DOTS-Telemetry use cases that use attributes included in DOTS Telemetry specifications.
      </t>
      <section anchor="section_use_cases_ddos_mitigation_optimal_resource_assign" title="Mitigation Resources Assignment">
        <section anchor="section_use_cases_ddos_mitigation_bandwidth_top-talker" title="Mitigating Attack Flow of Top-talker Preferentially">
          <t>
            Large-scale DDoS attacks, such as amplification attacks, often occur. Some transit providers have to mitigate large-scale DDoS attacks using DMS with limited resources, which is already deployed in their network.
          </t>
          <t>
            The aim of this use case is to enable transit providers to use their DMS efficiently under volume-based DDoS attacks whose bandwidth is more than the available capacity of the DMS.
            To enable this, attack traffic of top talkers is redirected to the DMS preferentially by cooperation among forwarding nodes, flow collectors, and orchestrators.
            Figure 1 gives an overview of this use case.
            Figure 2 gives an example of message body of DOTS telemetry.
          </t>
          <t>
            <figure align="center">
              <artwork><![CDATA[
(Internet Transit Provider)

               +-----------+      +--------------+ e.g., SNMP
  e.g., IPFIX +-----------+| DOTS |              |<---
          --->| Flow      ||C<-->S| Orchestrator | e.g., BGP Flowspec
              | collector |+      |              |--->   (Redirect)
              +-----------+       +--------------+

                         +-------------+
            e.g., IPFIX +-------------+| e.g., BGP Flowspec
                    <---| Forwarding  ||<---   (Redirect)
                        |    nodes    ||
                        |             ||           DDoS Attack
[ Target  ]<============|===============================
[   or    ]             |    ++=========================[top talker]
[ Targets ]             |    || ++======================[top talker]
                        +----|| ||---+
                             || ||
                             || ||
                             |/ |/
                        +----x--x----+
                        | DDoS       | e.g., SNMP
                        | mitigation |<---
                        | system     |
                        +------------+

* C is for DOTS client functionality
* S is for DOTS client functionality

Figure 1: Mitigating DDoS Attack Flow of Top-talker Preferentially

              ]]></artwork>
            </figure>
            <figure>
              <artwork><![CDATA[
{
  "ietf-dots-telemetry:telemetry": {
    "pre-or-ongoing-mitigation": [
      {
        "target": {
          "target-prefix": [
            "2001:db8::1/128"
          ]
        },
        "total-attack-traffic-protocol": [
          {
            "protocol": 17,
            "unit": "megabit-ps",
            "mid-percentile-g": "900"
          }
        ],
        "attack-detail": [
          {
            "vendor-id": 1234,
            "attack-id": 77,
            "start-time": "1957811234",
            "attack-severity": "high",
            "top-talker":{
              "talker": [
                {
                  "source-prefix": "2001:db8::2/128",
                  "total-attack-traffic":[
                    {
                      "unit": "megabit-ps",
                      "mid-percentile-g": "100"
                    }
                  ]
                },
                {
                  "source-prefix": "2001:db8::3/128",
                  "total-attack-traffic":[
                    {
                      "unit": "megabit-ps",
                      "mid-percentile-g": "90"
                    }
                  ]
                }
              ]
            }
          }
        ]
      }
    ]
  }
}

Figure 2: Example of Message Body
              ]]></artwork>
            </figure>
          </t>
          <t>
            In this use case, the forwarding nodes always send statistics of traffic flow to the flow collectors by using monitoring functions such as IPFIX<xref target="RFC7011" />.
            When DDoS attacks occur, the flow collectors detect attack traffic and send (src_ip, dst_ip, bandwidth)-tuple information of the top talker to the orchestrator using the target-prefix and top-talkers attribute of DOTS Telemetry.
            The orchestrator then checks the available capacity of DMS by using a network management protocol such as SNMP<xref target="RFC3413" />.
            After that, the orchestrator orders forwarding nodes to redirect as much of the top taker's traffic to the DMS as possible by dissemination of flow-specification-rule protocols such as BGP Flowspec<xref target="RFC5575" />.
          </t>
          <t>
            In this case, the flow collector implements a DOTS client while the orchestrator implements a DOTS server.
          </t>
        </section>
        <section anchor="dms_selection" title="Optimal DMS Selection for Mitigation">
          <t>
            Transit providers, which have a number of DMSs, can deploy the DMSs in clustered form.
            In the form, they can select DMS to be used to mitigate DDoS attack under attack time.
          </t>
          <t>
            The aim of this use case is to enable transit providers to select an optimal DMS for mitigation based on the bandwidth of attack traffic, capacity of a DMS.
            Figure 3 gives an overview of this use case.
            Figure 4 gives an example of message body of DOTS telemetry.
          </t>
          <t>
            <figure align="center">
              <artwork><![CDATA[
(Internet Transit Provider)

               +-----------+      +--------------+ e.g., SNMP
  e.g., IPFIX +-----------+| DOTS |              |<---
          --->| Flow      ||C<-->S| Orchestrator | e.g., BGP
              | collector |+      |              |--->   (Redirect)
              +-----------+       +--------------+

                         +------------+
            e.g., IPFIX +------------+| e.g., BGP
                    <---| Forwarding ||<---   (Redirect)
                        |    nodes   ||
                        |            ||            DDoS Attack
[Target]                | ++============================
[Target]                | ||  ++========================
                        +-||--||-----+
                          ||  ||
                    ++====++  ||  (congested DMS)
                    ||        ||  +-----------+
                    ||        |/  |      DMS3 |
                    ||  +-----x------+        |<--- e.g., SNMP
                    |/  |       DMS2 |--------+
                 +--x---------+      |<--- e.g., SNMP
                 |       DMS1 |------+
                 |            |<--- e.g., SNMP
                 +------------+

* C is for DOTS client functionality
* S is for DOTS client functionality

Figure 3: Optimal DMS selection for Mitigation
              ]]></artwork>
            </figure>
            <figure>
            <artwork><![CDATA[

Note: Insert China mobile's message body

Figure 4: Example of Message Body
            ]]></artwork>
          </figure>
          </t>
          <t>
            In this use case, the forwarding nodes always send statistics of traffic flow to the flow collectors by using monitoring functions such as IPFIX<xref target="RFC7011" />.
            When DDoS attacks occur, the flow collectors detect attack traffic and send (dst_ip, bandwidth)-tuple information to the orchestrator using the target-prefix and total-attack-traffic attribute of DOTS Telemetry.
            The orchestrator then checks the available capacity of the DMSs by using a network management protocol such as SNMP<xref target="RFC3413" />.
            After that, the orchestrator chooses optimal DMS which each attack traffic should be redirected.
            The orchestrator then orders forwarding nodes to redirect the attack traffic to the optimal DMS by a routing protocol such as BGP<xref target="RFC4271" />.
            The algorithm of selecting a DMS is out of the scope of this draft.
          </t>
          <t>
            In this case, the flow collector implements a DOTS client while the orchestrator implements a DOTS server.
          </t>
        </section>
        <section anchor="redirection_path_selection" title="Best-path Selection for Redirection">
          <t>
            A transit-provider network, which adopts a mesh network, has multiple paths to convey attack traffic to a DMS.
            In this network, attack traffic can be conveyed while avoiding congested links by selecting an available path.
          </t>
          <t>
            The aim of this use case is to enable transit providers to select an optimal path for redirecting attack traffic to a DMS according to the bandwidth of the attack traffic, total traffic, and total pipe capability.
            Figure 5 gives an overview of this use case.
            Figure 6 gives an example of message body of DOTS telemetry.
          </t>
          <t>
            <figure align="center">
              <artwork><![CDATA[
(Internet Transit Provider)

          +-----------+      +--------------+ DOTS
  e.g.,  +-----------+|      |              |S<---
   IPFIX | Flow      || DOTS | Orchestrator |
      -->| collector ||C<-->S|              | e.g., BGP Flow spec
         |           |+      |              |--->   (Redirect)
         +-----------+       +--------------+

               DOTS +------------+  DOTS +------------+ e.g., IPFIX
               --->C| Forwarding |  --->C| Forwarding |--->
e.g., BGP Flow spec |   node     |       |   node     |
     (Redirect) --->|            |       |            |  DDoS Attack
[Target]            |       ++====================================
                    +-------||---+       +------------+
                            ||              /
                            ||             / (congested link)
                            ||            /
                    DOTS  +-||----------------+ e.g., BGP Flow spec
                     --->C| ||  Forwarding    |<---   (Redirect)
                          | ++===  node       |
                          +----||-------------+
                               |/
                            +--x-----------+
                            |     DMS      |
                            +--------------+

* C is for DOTS client functionality
* S is for DOTS client functionality

Figure 5: Best-path Selection for Redirection
              ]]></artwork>
            </figure>
            <figure>
            <artwork><![CDATA[

Note: Insert China mobile's message body

Figure 6: Example of Message Body
            ]]></artwork>
          </figure>
          </t>
          <t>
            In this use case, the forwarding nodes always send statistics of traffic flow to the flow collectors by using monitoring functions such as IPFIX<xref target="RFC7011" />.
            When DDoS attacks occur, the flow collectors detect attack traffic and send (dst_ip, bandwidth)-tuple information to the orchestrator using a target-prefix and total-attack-traffic attribute of DOTS Telemetry.
            On the other hands, forwarding nodes send bandwidth of total traffic passing the node and total pipe capability to the orchestrator using total-traffic and total-pipe-capability attributes of DOTS Telemetry.
            The orchestrator then selects an optimal path to which each attack-traffic flow should be redirected.
            After that, the orchestrator orders forwarding nodes to redirect the attack traffic to the optimal DMS by dissemination of flow-specification-rules protocols such as BGP Flowspec<xref target="RFC5575" />.
            The algorithm of selecting a path is out of the scope of this draft.
          </t>
        </section>
        <section anchor="section_use_cases_ddos_mitigation_bandwidth_offloadingvolumetricattackflow" title="Short but Extreme Volumetric Attack Mitigation">
           <t>
             Short but extreme volumetric attacks, such as pulse wave DDoS attacks, are threats to internet transit provider networks.
             It is difficult for them to mitigate an attack by DMS by redirecting attack flows because it may cause route flapping in the network.
             The practical way to mitigate short but extreme volumetric attacks is to offload a mitigation actions to a forwarding node.
          </t>
          <t>
            The aim of this use case is to enable transit providers to mitigate short but extreme volumetric attacks.
            Furthermore, the aim is to estimate the network-access success rate based on the bandwidth of attack traffic and total pipe capability.
            Figure 7 gives an overview of this use case.
            Figure 8 gives an example of message body of DOTS telemetry.
          </t>
          <t>
            <figure align="center">
              <artwork><![CDATA[
(Internet Transit Provider)

          +------------+       +----------------+
e.g.,     | Network    |  DOTS | Administrative |
Alert --->| Management |C<--->S| System         | e.g., BGP Flow spec
          | System     |       |                |--->   (Rate-Limit)
          +------------+       +----------------+

            +------------+     +------------+ e.g., BGP Flow spec
            | Forwarding |     | Forwarding |<---  (Rate-Limit X bps)
            |   node     |     |   node     |
            |            |     |            | DDoS & Normal traffic
[Target]<------------------------------------================
Pipe        +------------+     +------------+  Attack Traffic
Capability                                     Bandwidth
e.g., X bps                                    e.g., Y bps

                    Network access success rate
                        e.g., X / (X + Y)

* C is for DOTS client functionality
* S is for DOTS client functionality

Figure 7: Short but Extreme Volumetric Attack Mitigation

           ]]></artwork>
            </figure>
            <figure>
            <artwork><![CDATA[

Note: Insert China mobile's message body

Figure 8: Example of Message Body
            ]]></artwork>
          </figure>
          </t>
          <t>
            In this use case, when DDoS attacks occur, the network management system receives alerts.
            It then sends the target ip address, pipe capability of the target's link, and bandwidth of the DDoS attack traffic to the administrative system using the target-prefix, total-pipe-capability and total-attack-traffic attributes of DOTS Telemetry.
            After that, the administrative system orders upper forwarding nodes to carry out rate-limit all traffic destined to the target based on the pipe capability by the dissemination of the flow-specification-rules protocols such as BGP Flowspec<xref target="RFC5575" />.
            In addition, the administrative system estimates the network-access success rate of the target, which is calculated by total pipe capability / (total pipe capability + total attack traffic).
          </t>
        </section>
          <section anchor="section_use_cases_ddos_mitigation_attack_type_techniqueselection" title="Selecting Mitigation Technique Based on Attack Type">
            <t>
              Some volumetric attacks, such as amplification attacks, can be detected with high accuracy by checking the layer-3 or layer-4 information of attack packets.
              These attacks can be detected and mitigated through cooperation among forwarding nodes and flow collectors using IPFIX<xref target="RFC7011" />.
              On the other hand, it is necessary to inspect the layer-7 information of attack packets to detect attacks such as DNS Water Torture Attacks.
              Such attack traffic should be detected and mitigated at a DMS.
            </t>
            <t>
              The aim of this use case is to enable transit providers to select a mitigation technique based on the type of attack traffic: amplification attack or not.
              To use such a technique, attack traffic is blocked at forwarding nodes or redirected to a DMS based on attack type through cooperation among forwarding nodes, flow collectors, and an orchestrator.
              Figure 9 gives an overview of this use case.
              Figure 10 gives an example of message body of DOTS telemetry.
            </t>
            <t>
              <figure align="center">
                <artwork><![CDATA[
  (Internet Transit Provider)

           +-----------+ DOTS +--------------+ e.g.,
    e.g., +-----------+|<---->|              | BGP (Redirect)
    IPFIX | Flow      ||C    S| Orchestrator | BGP Flowspec (Drop)
      --->| collector |+      |              |--->
          +-----------+       +--------------+

                      +------------+ e.g., BGP (Redirect)
         e.g., IPFIX +------------+|       BGP Flowspec (Drop)
                 <---| Forwarding ||<---
                     |    nodes   ||              DDoS Attack
                     |     ++=====||================
                     |     ||     ||x<==============[e.g.,DNS Amp]
                     |     ||     |+x<==============[e.g.,NTP Amp]
                     +-----||-----+
                           ||
                           |/
                     +-----x------+
                     | DDoS       |
                     | mitigation |
                     | system     |
                     +------------+

  * C is for DOTS client functionality
  * S is for DOTS server functionality

Figure 9: DDoS Mitigation Based on Attack Type

                ]]></artwork>
            </figure>
            <figure>
            <artwork><![CDATA[

China mobile's message body

Figure 10: Example of Message Body
            ]]></artwork>
          </figure>
          </t>
          <t>
            In this use case, the forwarding nodes send statistics of traffic flow to the flow collectors by using a monitoring function such as IPFIX<xref target="RFC7011" />.
            When DDoS attacks occur, the flow collectors detect attack traffic and send (dst_ip, attack_type)-tuple information to the orchestrator the using vendor-id and attack-id attribute of DOTS Telemetry.
            The orchestrator then resolves abused port and orders forwarding nodes to block the (dst_ip, src_port)-tuple flow of amp attack traffic by dissemination of flow-specification-rule protocols such as BGP Flowspec<xref target="RFC5575" />.
            On the other hand, the orchestrator orders forwarding nodes to redirect other traffic than the amp attack traffic by a routing protocol such as BGP<xref target="RFC4271" />.
          </t>
          <t>
            In this case, the flow collector implements a DOTS client while the orchestrator implements a DOTS server.
          </t>
          </section>
        </section>
      <section anchor="section_ddos_detailed_mitigation_report" title="Detailed DDoS Mitigation Report">
        <t>
          It is possible for the transit provider to add value to the DDoS mitigation service by reporting on-going and detailed DDoS countermeasure status to the enterprise network.
          In addition, it is possible for the transit provider to know whether the DDoS counter measure is effective or not by receiving reports from the enterprise network.
        </t>
        <t>
          The aim of this use case is to share the information about on-going DDoS counter measure between the transit provider and the enterprise network mutually.
          Figure 11 gives an overview of this use case.
          Figure 12 gives an example of message body of DOTS telemetry.
        </t>
        <t>
          <figure align="center">
            <artwork><![CDATA[
  +------------------+      +------------------------+
  | Enterprise       |      |    Upstream            |
  | Network          |      |    Internet Transit    |
  |  +------------+  |      |    Provider            |
  |  | Network    |C |      |   S+--------------+    |
  |  | admini-    |<----DOTS---->| Orchestrator |    |
  |  | strator    |  |      |    +--------------+    |
  |  +------------+  |      |         C ^            |
  |                  |      |           | DOTS       |
  |                  |      |         S v            |
  |                  |      |    +---------------+ DDoS Attack
  |                  |      |    |      DMS      |+=======
  |                  |      |    +---------------+   |
  |                  |      |           || Clean     |
  |                  |      |           |/ Traffic   |
  |  +---------+     |      |   +---------------+    |
  |  | DDoS    |     |      |   | Forwarding    | Normal Traffic
  |  | Target  |<===============| Node          |========
  |  +---------+     | Link |   +---------------+    |
  +------------------+      +------------------------+

* C is for DOTS client functionality
* S is for DOTS server functionality

Figure 11: Detailed DDoS Mitigation Report

            ]]></artwork>
          </figure>
          <figure>
            <artwork><![CDATA[
{
  "ietf-dots-telemetry:telemetry": {
    "pre-or-ongoing-mitigation": [
      {
        "tmid": 567,
        "target": {
          "target-prefix": [
            "2001:db8::1/128"
          ]
        },
        "target-protocol": [
          17
        ],
        "total-traffic": [
          {
            "unit": "megabit-ps",
            "mid-percentile-g": "800"
          }
        ],
        "total-attack-traffic": [
          {
            "unit": "megabit-ps",
            "mid-percentile-g": "100"
          }
        ],
        "attack-detail": [
          {
            "vendor-id": 1234,
            "attack-id": 77,
            "start-time": "1957818434",
            "attack-severity": "high"
          }
        ]
      }
    ]
  }
}

Figure 12: Example of Message Body
          ]]></artwork>
          </figure>
        </t>
        <t>
          In this use case, the network managements system in the enterprise network reports limits of incoming traffic volume from transit provider to the orchestrator in the transit provider in advance.
          It is reported by using total-pipe-capacity in DOTS telemetry.
        </t>
        <t>
          When DDoS attacks occurs, DDoS Orchestration <xref target="RFC8903" /> is carried out in the transit provider.
          Then, the DDoS mitigation systems reports status of DDoS counter measure to the orchestrator by using DOTS telemetry such as attack-detail.
          After that, the orchestrator integrates the reports from the DDoS mitigation system, while removing duplicate contents, and send it to network administrator by using DOTS telemetry periodically.
        </t>
        <t>
          During the DDoS mitigation, the orchestrator in the transit provider retrieves link congestion status from the network administrator in the enterprise network by using total-traffic in DOTS telemetry.
          Then, the orchestrator checks whether DDoS countermeasure is effective or not by comparing the total-traffic and the total-pipe-capacity.
        </t>
        <t>
          In this case, the DMS implements a DOTS server while the orchestrator implements a DOTS client and server in the transit provider.
          In addition, the network administrator implements a DOTS client.
        </t>
      </section>
      <section anchor="section_use_cases_dms_tuning" title="Tuning Mitigation Resources">
        <section anchor="section_use_cases_ddos_detection_training" title="Supervised Machine Learning of Flow Collector">
          <t>
            DDoS detection based on monitoring functions, such as IPFIX<xref target="RFC7011" />, is a lighter weight method of detecting DDoS attacks than DMSs in internet transit provider networks.
            On the other hand, DDoS detection based on the DMSs is a more accurate method of detecting attack traffic or DDoS attacks better than flow monitoring.
          </t>
          <t>
            The aim of this use case is to increases flow collector's detection accuracy by carrying out supervised machine-learning techniques according to attack detail reported by the DMSs.
            To use such a technique, forwarding nodes, flow collector, and a DMS should cooperate.
            Figure 13 gives an overview of this use case.
            Figure 14 gives an example of message body of DOTS telemetry.
          </t>
          <t>
            <figure align="center">
              <artwork><![CDATA[

                                +-----------+
                               +-----------+| DOTS
                   e.g., IPFIX | Flow      ||S<---
                           --->| collector ||
                               +-----------++

                                +------------+
                   e.g., IPFIX +------------+|
                           <---| Forwarding ||
                               |    nodes   ||           DDoS Attack
 [ Target ]                    |   ++==============================
                               |   || ++===========================
                               |   || || ++========================
                               +---||-|| ||-+
                                   || || ||
                                   |/ |/ |/
                         DOTS  +---X--X--X--+
                          --->C| DDoS       |
                               | mitigation |
                               | system     |
                               +------------+

        * C is for DOTS client functionality
        * S is for DOTS client functionality

Figure 13: Training Supervised Machine Learning of Flow Collector
              ]]></artwork>
            </figure>
            <figure>
              <artwork><![CDATA[
{
  "ietf-dots-telemetry:telemetry": {
    "pre-or-ongoing-mitigation": [
      {
        "target": {
          "target-prefix": [
            "2001:db8::1/128"
          ]
        },
        "total-attack-traffic-protocol": [
          {
            "protocol": 17,
            "unit": "megabit-ps",
            "mid-percentile-g": "900"
          }
        ],
        "attack-detail": [
          {
            "vendor-id": 1234,
            "attack-id": 77,
            "start-time": "1957811234",
            "attack-severity": "high",
            "top-talker": {
              "talker": [
                {
                  "source-prefix": "2001:db8::2/128",
                  "total-attack-traffic": [
                    {
                      "unit": "megabit-ps",
                      "mid-percentile-g": "100"
                    }
                  ]
                }
              ]
            }
          }
        ]
      }
    ]
  }
}

Figure 14: Example of Message Body
]]></artwork>
          </figure>
          </t>
          <t>
            In this use case, the forwarding nodes always send statistics of traffic flow to the flow collectors by using monitoring functions such as IPFIX<xref target="RFC7011" />.
            When DDoS attacks occur, DDoS orchestration use case<xref target="RFC8903"/> is carried out and the DMS mitigates all attack traffic destined for a target.
            The DDoS-mitigation system reports the vendor-id, attack-id and top-talker to the flow collector using DOTS telemetry.
          </t>
          <t>
            After mitigating a DDoS attack, the flow collector attaches teacher labels, which shows normal traffic or attack type, to the statistics of traffic flow of top-talker based on the reports.
            The flow collector then carries out supervised machine learning to increase its detection accuracy, setting the statistics as an explanatory variable and setting the labels as an objective variable.
          </t>
          <t>
            In this case, the DMS implements a DOTS client while the flow collector implements a DOTS server.
          </t>
      </section>
      <section anchor="section_use_cases_tuning_threshold" title="Unsupervised Machine Learning of Flow Collector">
        <t>
          DMSs can detect DDoS attack traffic, which means DMSs can also identify clean traffic.
          The aim of this use case is to carry out unsupervised machine-learning for anomaly detection according to baseline reported by DMSs.
          To use such a technique, forwarding nodes, flow collector, and a DMS should cooperate.
          Figure 15 gives an overview of this use case.
          Figure 16 gives an example of message body of DOTS telemetry.
        </t>
        <t>
          <figure align="center">
            <artwork><![CDATA[

                              +-----------+
                             +-----------+|
                        DOTS | Flow      ||
                        --->S| collector ||
                             +-----------++

                              +------------+
                             +------------+|
                             | Forwarding ||
                             |    nodes   ||             Traffic
[ Dst ] <========================++==============================
                             |   ||       ||
                             |   ||       |+
                             +---||-------+
                                 ||
                                 |/
                       DOTS  +---X--------+
                        --->C| DDoS       |
                             | mitigation |
                             | system     |
                             +------------+

      * C is for DOTS client functionality
      * S is for DOTS client functionality

Figure 15: Training Unsupervised Machine Learning of Flow Collector
            ]]></artwork>
          </figure>
          <figure>
<artwork><![CDATA[
  {
    "ietf-dots-telemetry:telemetry-setup": {
      "telemetry": [
        {
          "baseline": [
            {
              "id": 1,
              "target-prefix": [
                "2001:db8:6401::1/128"
              ],
              "target-port-range": [
                {
                  "lower-port": "53"
                }
              ],
              "target-protocol": [
                17
              ],
              "total-traffic-normal": [
                {
                  "unit": "megabit-ps",
                  "mid-percentile-g": "30",
                  "mid-percentile-g": "50",
                  "high-percentile-g": "60",
                  "peak-g": "70"
                }
              ]
            }
          ]
        }
      ]
    }
  }

Figure 16: Example of Message Body
              ]]></artwork>
          </figure>
        </t>
        <t>
          In this use case, the forwarding nodes carry out mirroring traffic destined a dst ip address.
          The DMS then identifies clean traffic and reports the baseline attributes to the flow collector using DOTS telemetry.
        </t>
        <t>
          The flow collector then carries out unsupervised machine learning to be able to carry out anomaly detection.
        </t>
        <t>
          In this case, the DMS implements a DOTS client while the flow collector implements a DOTS server.
        </t>
      </section>
    </section>
    </section>
    <section title="Security Considerations">
      <t>
        DOTS telemetry security considerations are discussed in <xref target="I-D.ietf-dots-telemetry" />. This document does not add new considerations.
      </t>
    </section>
    <section title="IANA Considerations">
      <t>
        This document does not require any action from IANA.
      </t>
    </section>
    <section title="Acknowledgement">
      <t>
        The authors would like to thank among others Mohamed Boucadair for their valuable feedback.
      </t>
    </section>
  </middle>
  <!-- ***** BACK MATTER ***** -->
  <back>
    <references title="Normative References">
      <?rfc include="reference.I-D.ietf-dots-telemetry"?>
      <?rfc include="reference.RFC.8903"?>
      <?rfc include="reference.RFC.4271"?>
      <?rfc include="reference.RFC.5575"?>
      <?rfc include="reference.RFC.8612"?>
      <?rfc include="reference.RFC.3413"?>
      <?rfc include="reference.RFC.7011"?>
    </references>
    <references title="Informative References">
      <?rfc include="reference.RFC.8782"?>
      <?rfc include="reference.RFC.8783"?>
    </references>
    <!-- Appendix -->
  </back>
</rfc>
